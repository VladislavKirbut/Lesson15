Это один общий чат, куда могут отправлять сообщения множество пользователей.

Иногда возникает задача ограничивать частоту некоторых событий. Возможно, вы слышали про DDoS-атаки, когда сервер подвергают угрозе, умышленно отправляя на него огромное количество запросов. Возможно, вы знакомы с таким понятием как флуд в соцсетях и мессенджерах – умышленная отправка большого количества однотипных сообщений пользователем.

Программы борются с этими атаками с помощью rate limiting. Rate limiting – ограничение количества запросов в единицу времени. Например, вы можете ограничить количество возможных запросов на создание сообщений от одного пользователя. Если пользователь превышает это ограничение, то просто не принимаются его новые сообщения. 

В чате будет реализация rate limiting. Rate limiting ограничение можно задать по-разному. В данном случае задаётся некоторый промежуток времени и максимальное количество сообщений, которые может отправить один пользователь за указанный промежуток времени. Например, максимально 30 сообщений от одного пользователя за 1 минуту времени. Когда пользователь пытается отправить новое сообщение, то считаются его предыдущие сообщения за последнюю минуту. Если их уже 30, то пользователь получает отказ.

– Создаётся класс, который хранит информацию о пользователе: никнейм (логин) пользователя

– Создаётся класс, который хранит информацию об одном сообщении в чате: автор сообщения, текстовое содержание сообщения, время отправки 

– Создаётся класс, который описывает бизнес-логику всего чата, хранит историю сообщений.
– Принимаются в конструкторе настройки для rate limiting – временной промежуток и максимальное количество сообщений, которые может отправить один пользователь за указанный промежуток времени (int)
– Объявляется метод, который возвращает всю историю чата
– Объявляется метод, который позволяет добавить в историю новое сообщение от указанного пользователя с указанным содержимым
– Перед созданием нового сообщения внутри метода проверяется, что за указанный в rate limiting промежуток времени пользователь ещё не достиг своего максимума сообщений. Промежуток времени отсчитывается от времени публикации нового сообщения. Если максимум ещё не достигнут, то сообщение успешно добавляется в историю. Если максимум уже достигнут, то новое сообщение не должно быть добавлено.

– Создаётся отдельный класс для демонстрации работы в консоли
– Создаётся объект сервиса. Передаются при вызове конструктора настройки rate limiting: временной промежуток, максимальное количество сообщений от одного пользователя за временной промежуток.

Реализация в таком виде:
– В бесконечном цикле запрашиваются из консоли строки
– Если строка “история”, то выводится история сообщений
– Иначе ожидается строка в формате “логин_пользователя: содержание_сообщения”. Так имитируется наличие нескольких пользователей. Запись означает, что пользователь с указанным логином хочет отправить сообщение с указанным содержанием
– Если сообщение не удалось отправить из-за rate limiting, выводится в консоль “Слишком частые запросы”
